{
    "contents" : "---\ntitle: \"Import CSV\"\nauthor: \"jp.decorps@epiconcept.fr\"\ndate: \"11/02/2015\"\noutput: html_document\n---\n\n# Import et recodage du CSV\n\n```{r results='asis'}\nlibrary(Epiconcepts)\n\nCN <- read.table(\"colnames.csv\", sep=\";\", colClasses=\"character\");\n\nGDS = read.table(\"invs.csv\", sep=\";\", colClasses=\"factor\");\nec.use(\"invs.csv\", sep=\";\");\n\ncolnames(GDS) <- CN[,1]\n#str(GDS)\nec.codebook();\nF = ec.freq(\"L1\");\nF\nec.plot(F);\nGDS[, \"L2\"] <- as.character(GDS[, \"L2\"]);\nec.recode(\"L2\", where = list (VAL(\"L2\") == 0,\n                              VAL(\"L2\") == 1,\n                              VAL(\"L2\") == 2,\n                              VAL(\"L2\") == 3,\n                              VAL(\"L2\") == 4,\n                              VAL(\"L2\") == 5,\n                              VAL(\"L2\") == 6,\n                              VAL(\"L2\") == 7,\n                              VAL(\"L2\") == 8,\n                              VAL(\"L2\") == 9),\n          by = list( \n            \"ACR 0\",\n            \"ACR 1\",\n            \"ACR 2\",\n            \"ACR 3\",\n            \"ACR 4\",\n            \"ACR 5\",\n            \"ACR 6 (0, 3, 4 ou 5)\",\n            \"Non L2\",\n            \"2nd CTI non\",\n            NA));\n\nGDS[, \"L2\"] <- as.factor(GDS[, \"L2\"]);\nF = ec.freq(\"L2\");\nF\nec.plot(F, title=\"Résultats de la lecture 2 (L2)\")\n\nGDS[, \"diag\"] <- as.character(GDS[, \"diag\"]);\nec.recode(\"diag\", where = list (VAL(\"diag\") == 0,\n                              VAL(\"diag\") == 1,\n                              VAL(\"diag\") == 2,\n                              VAL(\"diag\") == 3,\n                              VAL(\"diag\") == 4,\n                              VAL(\"diag\") == 5,\n                              VAL(\"diag\") == 6,\n                              VAL(\"diag\") == 9),\n          by = list( \n            \"0-Normal\",\n            \"1-Bénin\",\n            \"2-Cancer\",\n            \"3-Attente\",\n            \"4-PdV\",\n            \"5-Surveil.\",\n            \"6-DCD\",\n            \"9-Inconnu\"));\n\nF = ec.freq(\"diag\", where=c((VAL(\"L1\")==\"1\" | VAL(\"L1\")==\"2\") & VAL(\"diag\")==\"2-Cancer\")) \nTC = F@tableFreq$Freq;\nTOT = nrow(GDS);\ncat(sprintf(\"Taux (/1000) de cancers détectés à la deuxième lecture: %3.2f<br>\", (TC/TOT)*1000))\n\n# 1. Taux de cancer dépistés par commune\nD1 <- ec.freq(\"diag\", by=\"INSEE\", where=c(VAL(\"diag\")==\"2-Cancer\")) \nD2 <- ec.freq(\"INSEE\");\nINSEE = as.character(D1@tableFreq$INSEE);\nD3 <- data.frame(cbind(INSEE), stringsAsFactors = FALSE);\nD3$Depistage <- D2@tableFreq$Freq ;\nD3$Detecte <- D1@tableFreq$Freq;\nD3$Taux <- D3[,3] / D3[ ,2]*100;\n#ec.xtable(D3);\n\n# 2. Taux de cancer par type de mammographe\nGDS[, \"type_mammo\"] <- as.character(GDS[, \"type_mammo\"]);\nec.recode(\"type_mammo\", where = list (VAL(\"type_mammo\") == 1,\n                              VAL(\"type_mammo\") == 2,\n                              VAL(\"type_mammo\") == 3,\n                              VAL(\"type_mammo\") == 9),\n          by = list( \n            \"1-Analogique\",\n            \"2-Num. DR\",\n            \"3-Num. CR\",\n            \"9-Inconnu\"));\n\nD1 <- ec.freq(\"type_mammo\");\nD2 <- ec.freq(\"diag\", by=\"type_mammo\", where=c(VAL(\"diag\")==\"2-Cancer\"));\nD3 <- merge(D1@tableFreq, D2@tableFreq, by=\"type_mammo\");\nD3$diag <- NULL;\nD3$Taux <- D3[ ,3] / D3[ ,2]*100;\ncolnames(D3) <- c(\"Type de mammographe\", \"Effectuées\", \"Cancer\", \"Taux\");\nec.xtable(D3);\n\nGDS$date_biop <- as.Date(GDS$date_biop,format = \"%d%m%Y\");\nGDS$date_mammo <- as.Date(GDS$date_mammo,format = \"%d%m%Y\")\nDF <- GDS[!is.na(GDS$date_biop), c(\"date_mammo\",\"date_biop\")]\nDF$diff <- as.numeric(DF$date_biop - DF$date_mammo)\nDF$date_biop <- NULL\nDF2 <- aggregate(x=DF, by=list(DF$date_mammo), FUN = \"mean\")\nDF2$Group.1 <- NULL\np <- ggplot(DF2, aes(date_mammo, diff)) ;\np + stat_smooth(method=\"lm\") + geom_point()\n",
    "created" : 1424188201837.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "106542869",
    "id" : "7EC8EE61",
    "lastKnownWriteTime" : 1424194078,
    "path" : "~/R/INVS/script1.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}